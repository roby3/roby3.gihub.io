<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1251">
<meta http-equiv="Content-Language" content="uk">
<link rel=Edit-Time-Data href=21.files/editdata.mso>
<title>4.4.4. Віртуальні локальні мережі</title>
</head>
<body lang=Ua>
<h3>4.4.4. Віртуальні локальні мережі</h3>
<p>Крім свого основного призначення
- підвищення пропускної здатності зв'язків у мережі -
комутатор дозволяє локалізувати потоки інформації
в мережі, а також контролювати ці потоки й управляти ними, опираючись
на механізм користувацьких фільтрів. Однак користувацький фільтр може заборонити передачу кадрів
тільки по конкретних адресах, а широкомовний трафік передається всім
сегментам мережі. Так вимагає алгоритм роботи моста, що реалізований у комутаторі, тому мережі, створені на
основі мостів і комутаторів, іноді називають плоскими
- через відсутність бар'єрів на шляху широкомовного трафіка.</p>
<p>Технологія <b><i>віртуальних локальних мереж</i></b> (<b><i>Virtual</i></b><b><i>
LAN, VLAN</i></b>), що з'явилася кілька років тому назад у комутаторах, дозволяє побороти зазначене обмеження. Віртуальною мережею називається група вузлів мережі, трафік
якої, у тому числі й широкомовний, на
канальному рівні повністю ізольований від
інших вузлів мережі (мал. 4.39). Це означає,
що передача кадрів між різними віртуальними мережами
на підставі адреси канального рівня неможлива, незалежно від типу адреси - унікальної, групової
або широкомовної. У той же час усередині
віртуальної мережі кадри передаються за
технологією комутації, тобто тільки на той порт, що зв'язаний з адресою
призначення кадру. Віртуальні мережі можуть
перетинатися, якщо один або кілька комп'ютерів
входять до складу більш ніж однієї віртуальної
мережі. На мал. 4.39 сервер електронної пошти
входить до складу <b>3</b> й <b>4</b> віртуальних мереж.
Це значить, що його кадри передаються комутаторами всім комп'ютерам, що входять
у ці мережі. Якщо ж якийсь комп'ютер входить
до складу тільки віртуальної мережі <b>3</b>, то його кадри до мережі <b>4</b><b>доходити не будуть</b>, 
<b>але він може взаємодіяти з комп'ютерами мережі
4</b> через загальний поштовий сервер. Така
схема не повністю захищає віртуальні мережі друг від друга - так, широкомовний шторм, що виникає на сервері електронної пошти, захлисне мережа 3 і мережа
4.</p>
<table border="0" width="100%" id="table1">
	<tr>
		<td align="center">
<img width=484 height=480 src=images/m39.jpg alt="Мал. 4.39. Віртуальні мережі"></td>
	</tr>
	<tr>
		<td align="center">Мал. 4.39. Віртуальні мережі</td>
	</tr>
</table>
<p>Говорять, що віртуальна мережа
утворить <b><i>домен широкомовного трафіка</i></b> (<b><i>broadcast</i></b><b><i> domain</i></b>),
за аналогією з доменом
колізій, який утворюється повторювачами мереж Ethernet.</p>
<p>Призначення технології
віртуальних мереж складається
в полегшенні процесу створення ізольованих мереж,
які потім повинні зв'язуватися за допомогою маршрутизаторів, що реалізують який-небудь
протокол мережного рівня, наприклад IP. Така побудова мережі створює набагато могутніші бар'єри на шляху помилкового трафіка з однієї мережі в
іншу. Сьогодні вважається, що будь-яка велика мережа повинна включати маршрутизатори, інакше
потоки помилкових кадрів, наприклад широкомовних,
будуть періодично затоплювати всю мережу через
прозорі для них комутатори, приводячи її в непрацездатний
стан.</p>
<p>Технологія віртуальних мереж створює гнучку основу для побудови великої мережі, з'єднаної
маршрутизаторами, тому що комутатори дозволяють створювати повністю ізольовані сегменти програмним шляхом, не прибігаючи
до фізичної комутації.</p>
<p>До появи технології VLAN для
створення окремої мережі використовувалися або фізично ізольовані сегменти
коаксіального кабелю, або незв'язані між собою
сегменти, побудовані на повторювачах і мостах.
Потім ці мережі зв'язувалися маршрутизаторами
в єдину складену мережу
(мал. 4.40).</p>
<table border="0" width="100%" id="table2">
	<tr>
		<td align="center">
<img width=412 height=378 src=images/m40.jpg alt="Мал. 4.40. Інтермережа, що складається з мереж, побудованих на основі повторювачів"></td>
	</tr>
	<tr>
		<td align="center">Мал. 4.40. Інтермережа, що складається з мереж,
побудованих на основі повторювачів</td>
	</tr>
</table>
<p>Зміна складу
сегментів (перехід користувача в іншу мережу,
дроблення великих сегментів) при такому підході має на увазі фізичну перекомутацію рознімань на передніх панелях повторювачів
або в кросових панелях, що не дуже зручні в великих мережах -
багато фізичної роботи, до того ж висока ймовірність помилки.</p>
<p>Тому для усунення необхідності
фізичної перекомутації вузлів стали застосовувати багатосегменті
концентратори, розглянуті в розділі 4.2.2. Виникла можливість програмувати склад поділюваного сегмента без фізичної перекомутації.</p>
<p>Однак рішення
завдання зміни складу
сегментів за допомогою концентраторів накладає більші
обмеження на структуру мережі - кількість
сегментів такого повторювача звичайно невелика,
тому виділити кожному вузлу свій сегмент, як
це можна зробити за допомогою комутатора, нереально. Крім того, при такому
підході вся робота з передачі даних між сегментами лягає на маршрутизатори, а
комутатори зі своєю високою продуктивністю залишаються не при справах. Тому мережі, побудовані
на основі повторювачів з конфігураційною
комутацією, як і раніше засновані на поділі середовища передачі даних між великою кількістю вузлів, і, отже, мають набагато
меншу продуктивність у порівнянні з мережами,
побудованими на основі комутаторів.</p>
<p>При використанні технології
віртуальних мереж у комутаторах одночасно вирішуються два завдання:</p>
<ol start=1 type=1>
	<li>підвищення продуктивності в кожній з віртуальних мереж, тому що комутатор передає кадри в такій мережі тільки вузлу призначення;</li>
	<li>ізоляція мереж друг від друга для керування правами доступу користувачів і створення захисних бар'єрів на шляху широкомовних штормів.</li>
</ol>
<p>Для зв'язку
віртуальних мереж у загальну
мережу потрібно залучення мережного рівня. Він може бути реалізований в
окремому маршрутизаторі, а може працювати й у складі програмного забезпечення
комутатора, що тоді стає комбінованим пристроєм
- так званим комутатором 3-го рівня. Комутатори 3-го рівня розглядаються в главі 5.</p>
<p>Технологія утворення й роботи віртуальних мереж за допомогою комутаторів довгий час не
стандартизувалася, хоча й була реалізована в дуже широкому спектрі моделей
комутаторів різних виробників. Таке положення
змінилося після прийняття в 1998 році стандарту IEEE 802.1Q, що визначає базові правила побудови віртуальних
локальних мереж, що не залежать від протоколу
канального рівня, який підтримує комутатор.</p>
<p>У зв'язку довгої відсутності стандарту на VLAN кожен великий виробник комутаторів розробив свою
технологію віртуальних мереж, що, як правило,
була несумісна з технологіями інших
виробників. Тому, незважаючи на появу стандарту, можна не так вуж рідко
зустрітися із ситуацією, коли віртуальні мережі,
створені на комутаторах одного виробника, не
розпізнаються й, відповідно, не підтримуються комутаторами іншого виробника.</p>
<p>При створенні віртуальних мереж на основі одного комутатора звичайно використовується механізм групування в мережі портів комутатора (мал. 4.41). При цьому кожен порт приписується тій
або іншій віртуальної мережі. Кадр, що прийшов
від порту, що належить, наприклад, віртуальної мережі
1, ніколи не буде переданий порту, що не
належить цій віртуальній мережі. Порт можна
приписати декільком віртуальним мережам, хоча на практиці так роблять рідко -
пропадає ефект повної ізоляції мереж.</p>
<p>Групування портів для одного комутатора - найбільш
логічний спосіб утворення VLAN, тому що
віртуальних мереж, побудованих
на основі одного комутатора, не може бути більше, ніж портів. Якщо до одного
порту підключений сегмент, побудований на
основі повторювача, то вузли такого сегмента не мають сенсу
включати в різні віртуальні мережі - однаковий
трафік цих вузлів буде
загальним.</p>
<p>Створення віртуальних мереж на основі групування портів не вимагає від
адміністратора великого обсягу ручної роботи -
досить кожен порт приписати до однієї з декількох заздалегідь пойменованих віртуальних мереж. Звичайно така операція виконується за
допомогою спеціальної програми, прикладеної до
комутатора. Адміністратор створює віртуальні мережі
шляхом перетаскування мишею графічних символів портів на графічні символи мереж.</p>
<table border="0" width="100%" id="table3">
	<tr>
		<td align="center">
<img width=374 height=484 src=images/m41.jpg alt="Мал. 4.41. Віртуальні мережі, побудовані на одному комутаторі"></td>
	</tr>
	<tr>
		<td align="center">Мал. 4.41. Віртуальні мережі,
побудовані на одному комутаторі</td>
	</tr>
</table>
<p>Другий спосіб побудови віртуальних мереж
заснований на групуванні Мас-адрес. Кожна Мас-адреса, що вивчена комутатором, приписується тій або іншій віртуальній мережі.
При існуванні в мережі багатьох вузлів цей спосіб вимагає виконання великої кількості
ручних операцій від адміністратора. Однак він виявляється
більше гнучким
при побудові віртуальних мереж на основі декількох комутаторів, чим
спосіб групування портів.</p>
<table border="0" width="100%" id="table4">
	<tr>
		<td align="center">
<img width=494 height=237 src=images/m42.jpg alt="Мал. 4.42. Побудова віртуальних мереж на декількох комутаторах з групуванням портів"></td>
	</tr>
	<tr>
		<td align="center">Мал. 4.42. Побудова віртуальних мереж на декількох
комутаторах з групуванням
портів</td>
	</tr>
</table>
<p>Малюнок 4.42 ілюструє проблему,
що виникає при створенні віртуальних мереж на
основі декількох комутаторів, що підтримують
техніку групування портів. Якщо вузли якої-небудь віртуальної мережі підключені до різних комутаторів, то для з'єднання комутаторів кожної такої мережі повинна бути виділена своя пара портів. У
противному випадку, якщо комутатори будуть зв'язані
тільки однією парою портів, інформація про приналежність кадру тій
або іншій віртуальної мережі при передачі з
комутатора в комутатор буде загублена. Таким чином, комутатори з групуванням
портів вимагають для свого з'єднання стільки
портів, скільки віртуальних мереж вони підтримують. Порти й кабелі використовуються при такому способі дуже
марнотратно. Крім того, при з'єднанні
віртуальних мереж через маршрутизатор для
кожної віртуальної мережі виділяється в цьому
випадку окремий кабель й окремий порт маршрутизатора, що також приводить до великих накладних витрат.</p>
<p>Групування Мас-адрес у віртуальну мережу
на кожному комутаторі рятує від необхідності їхнього зв'язку
декількома портами, тому що в цьому випадку Мас-адреса є влучної
віртуальної мережі. Однак цей спосіб вимагає
виконання великої кількості ручних операцій по маркуванню
Мас-адрес на кожному комутаторі мережі.</p>
<p>Описані два
підходи засновані тільки на додаванні додаткової інформації до адресних таблиць
моста, і в них відсутня можливість
вбудовування інформації про приналежності
кадру до віртуальної мережі в переданий кадр.
Інші підходи використовують наявні або
додаткові поля кадру для збереження інформації й приналежності
кадру при його переміщеннях між комутаторами мережі.
При цьому немає необхідності запам'ятовувати в кожному комутаторі приналежність всіх Мас-адрес
інтермережі віртуальним мережам.</p>
<p>Додаткове поле з позначкою про номер віртуальної мережі використовується
тільки тоді, коли кадр передається від комутатора до комутатора, а при передачі
кадру кінцевому вузлу воно видаляється. При цьому модифікується протокол
взаємодії &quot;комутатор – комутатор&quot;, а програмне й апаратне
забезпечення кінцевих вузлів залишається незмінним. Прикладів таких фірмових протоколів
багато, але загальний недолік
у них один - вони не підтримуються іншими
виробниками. Компанія Cisco запропонувала як
стандартну добавку до кадрів будь-яких
протоколів локальних мереж заголовок протоколу
802.10, призначеного для підтримки функцій безпеки обчислювальних мереж.
Сама компанія використовує цей метод у тих
випадках, коли комутатори поєднуються між
собою за протоколом FDDI. Однак ця ініціатива
не була підтримана іншими провідними
виробниками комутаторів.</p>
<p>Для зберігання
номера віртуальної мережі в стандарті IEEE
802.1Q передбачений той же додатковий заголовок, що й стандарт 802.1р. Крім 3-х
біт для зберігання пріоритету кадру, описаних стандартом 802.1р,
у цьому заголовку 12 біт використовуються для зберігання номера VLAN, до якої належить кадр. Ця
додаткова інформація дозволяє комутаторам різних виробників створювати до 4096 загальних віртуальних мереж.
Щоб кадр Ethernet не збільшувався в обсязі, при додаванні заголовка 802.1p/Q поле даних
зменшується на 2 байти.</p>
<p>Існують два способи побудови
віртуальних мереж, які використають вже наявні поля для маркування
приналежності кадру віртуальної мережі, однак ці поля належать не кадрам канальних
протоколів, а пакетам мережного рівня або коміркам технології ATM.</p>
<p>У першому випадку віртуальні мережі створюються на основі мережевих адрес, наприклад адрес IP, тобто тієї ж інформації, що використовується
при побудові інтермереж традиційним способом. Цей ефективний спосіб працює
тоді, коли комутатори підтримують не тільки протоколи канального рівня, але й
протоколи мережевого рівня, тобто є комбінованими комутаторами-маршрутизаторами, що
буває далеко не завжди.</p>
<p>У другому випадку віртуальні мережі організуються за допомогою віртуальних шляхів в ATM-мережах.</p>
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="table1">
  <tr>
    <td width="100%" align="left" colspan="3"><hr color="#2D4C54" size="4"></td>
  </tr>
  <tr>
    <td width="33%" align="left"><a href="020.htm">Попередня</a></td>
    <td width="33%" align="center"><a href="001.htm">Перша</a></td>
    <td width="34%" align="right"><a href="022.htm">Наступна</a></td>
  </tr>
</table>
</body>
</body>
</html>
