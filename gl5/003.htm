<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1251">
<meta http-equiv="Content-Language" content="uk">
<link rel=Edit-Time-Data href=../3.files/editdata.mso>
<title>5.1.3. Принципи маршрутизації</title>
</head>
<body lang=aU>
<h3>5.1.3.
Принципи маршрутизації</h3>
<p><b>Найважливішим завданням мережевого
рівня є маршрутизація - передача пакетів між
двома кінцевими вузлами в складеної мережі.</b></p>
<p>Розглянемо принципи маршрутизації на прикладі складеної мережі, зображеної на мал. 5.2. У цій мережі 20 маршрутизаторів поєднують
18 мереж у загальну
мережу; S1, S2, ... , S20 - це номера мереж.
Маршрутизатори мають по декілька портів
(принаймні, по два), до яких приєднуються мережі.
Кожний порт маршрутизатора можна розглядати як
окремий вузол мережі: він має власну мережеву адресу й власну
локальну адресу
в тій підмережі,
що до нього підключена. Наприклад,
маршрутизатор під номером <b>1 </b>має три порти, до
яких підключені мережі <b>S1</b>, <b>S2</b>, <b>S3</b>. На малюнку мережеві адреси цих портів позначені як 
<b>М1(1), М1(2)</b>
і <b>М1(3)</b>. Порт <b>М1(1)</b> має локальну адресу в мережі з номером <b>S1</b>, порт 
<b>М1(2)</b> - у мережі <b>S2</b>, а порт<b> М1(3)</b> - у мережі
<b>S3</b>. Таким чином, маршрутизатор можна розглядати як сукупність декількох вузлів, кожний
з яких входить у свою мережу. Як єдиний пристрій маршрутизатор не має ні окремої мережевої
адреси, ні якої-небудь локальної адреси.</p>
<p><i>Якщо маршрутизатор має блок керування (наприклад, SNMP-керування), то цей блок
має власні локальну і мережну
адреси, по яких до нього звертається центральна станція керування, що перебуває десь у складеній мережі.</i></p>
<p>У складних складених мережах
майже завжди існує кілька альтернативних маршрутів для передачі пакетів між
двома кінцевими вузлами. Маршрут — це послідовність маршрутизаторів, які
повинен пройти пакет від відправника до пункту
призначення. Так, пакет, відправлений з вузла
<b>А</b> в вузол <b>В</b>, може пройти через маршрутизатори
<b>17, 12, 5, 4</b> й <b>1</b> або маршрутизатори <b>17, 13, 7, 6</b> й <b>3</b>. Неважко знайти ще кілька
маршрутів між вузлами <b>А</b> и <b>В</b>.</p>
<table border="0" width="100%" id="table1">
	<tr>
		<td align="center">
<img width=499 height=624
src=images/im002.jpg v:shapes=_x0000_i1025 alt="Мал.&nbsp;5.2. Принципи маршрутизації в складеній мережі"></td>
	</tr>
	<tr>
		<td align="center">Мал.&nbsp;5.2. Принципи маршрутизації в складеній мережі</td>
	</tr>
</table>
<p>Завдання вибору маршруту з декількох можливих вирішують маршрутизатори, а також кінцеві
вузли. Маршрут вибирається на підставі наявної в
цих пристроях інформації про поточну
конфігурацію мережі, а також на підставі зазначеного критерію вибору маршруту. Звичайно як
критерій виступає затримка проходження маршруту окремим пакетом або середньою
пропускною здатністю маршруту для
послідовності пакетів. Часто також використовується
досить простий критерій, що враховує тільки
кількість пройдених у маршруті проміжних маршрутизаторів (<i><b>хопів</b></i>).</p>
<p>Щоб за адресою мережі призначення можна було б вибрати раціональний
маршрут подальшого проходження пакета, кожний
кінцевий вузол і маршрутизатор аналізують спеціальну інформаційну структуру, що
називається <b>таблицею маршрутизації</b>. Використовуючи умовні позначки для мережевих адрес маршрутизаторів і номерів мереж у тім вигляді,
як вони наведені на мал. 5.2, подивимося, як
могла б виглядати таблиця маршрутизації, наприклад, у маршрутизаторі 4 (табл.
5.1).</p>
<table border=1 cellspacing=0 cellpadding=2 width="100%">
	<caption style="text-align: left"><b><i>Таблиця 5.1. </i></b><i>Таблиця маршрутизації маршрутизатора 4</i></caption>
	<tr>
		<th>
		Номер мережі <br>
		призначення</th>
		<th>
		Мережева адреса <br>
		наступного маршрутизатора</th>
		<th>
		Мережева адреса <br>
		вихідного порту</th>
		<th>
		Відстань до <br>
		мережі призначення</th>
	</tr>
	<tr>
		<td align="center">
		S1</td>
		<td align="center">
		М1(2)</td>
		<td align="center">
		М4(1)</td>
		<td align="center">
		1</td>
	</tr>
	<tr>
		<td align="center">
		S2</td>
		<td align="center">
		—</td>
		<td align="center">
		М4(1)</td>
		<td align="center">
		0 (приєднана)</td>
	</tr>
	<tr>
		<td align="center">
		S3</td>
		<td align="center">
		М1(2)</td>
		<td align="center">
		М4(1)</td>
		<td align="center">
		1</td>
	</tr>
	<tr>
		<td align="center">
		S4</td>
		<td align="center">
		М2(1)</td>
		<td align="center">
		М4(1)</td>
		<td align="center">
		1</td>
	</tr>
	<tr>
		<td align="center">
		S5</td>
		<td align="center">
		—</td>
		<td align="center">
		М4(2)</td>
		<td align="center">
		0 (приєднана)</td>
	</tr>
	<tr>
		<td align="center">
		S6</td>
		<td align="center">
		М2(1)</td>
		<td align="center">
		М4(1)</td>
		<td align="center">
		2</td>
	</tr>
	<tr>
		<td align="center">
		Default</td>
		<td align="center">
		М5(1)</td>
		<td align="center">
		М4(2)</td>
		<td align="center">
		—</td>
	</tr>
</table>
<table border="0" cellpadding="0" cellspacing="1" width="100%" id="table2">
	<tr>
		<td><b><i>Примітка</i></b></td>
	</tr>
	<tr>
		<td><i>Таблиця 5.1 значно
спрощена в порівнянні з реальними таблицями, наприклад, відсутні стовпці з масками,
ознаками стану маршруту, часом, протягом якого
дійсні записи даної таблиці (їхнє застосування буде розглянуто
пізніше). Крім того, як уже були сказано, тут зазначені
адреси мереж умовного формату, які не
відповідають якому-небудь певному мережному протоколу.
Проте ця таблиця містить основні поля, наявні
в реальних таблицях при використанні конкретних мережних
протоколів, таких як IP, IPX або Х.25.</i></td>
	</tr>
</table>
<p>У першому стовпці таблиці перераховуються
номери мереж, що входять в інтермережу. У
кожному рядку таблиці слідом за номером мережі
вказується мережева адреса наступного
маршрутизатора (більш точно, мережева адреса відповідного порту наступного
маршрутизатора), на який слід направити
пакет, щоб той пересувався в напрямку до мережі
з даним номером за раціональним маршрутом.</p>
<p>Коли на маршрутизатор надходить новий пакет, номер мережі призначення, витягнутий з
кадру, що надійшов, послідовно порівнюється з номерами мереж з
кожного рядка таблиці. Рядок з номером мережі, що збігся, вказує, на який найближчий
маршрутизатор треба направити пакет. Наприклад, якщо на який-небудь порт
маршрутизатора <b>4</b> надходить пакет, адресований у мережу
<b>S6</b>, то з таблиці маршрутизації слідує, що адреса
наступного маршрутизатора - <b>М2(1)</b>, тобто черговим етапом прямування даного пакета буде прямування до 
<b>порту 1 маршрутизатора 2</b>.</p>
<p>Оскільки пакет може бути
адресований у будь-яку мережу складеної мережі,
може показатися, що кожна таблиця
маршрутизації повинна мати записи про всі мережі, що входять у складену
мережу. Але при такому підході у випадку
великої мережі обсяг
таблиць маршрутизації може виявитися дуже великим, що вплине на час її перегляду, зажадає
багато місця для зберігання й т.п. Тому на
практиці число записів у таблиці маршрутизації
намагаються зменшити за рахунок використання спеціального
запису — <i>&quot;маршрутизатор за замовчуванням&quot;
(default)</i>. Дійсно, якщо взяти до уваги топологію складеної
мережі, то в таблицях маршрутизаторів, що перебувають на периферії складеної
мережі, досить записати номера мереж,
безпосередньо приєднаних до даного
маршрутизатора або розташованих поблизу, на
тупикових маршрутах. Про всі ж інші мережі
можна зробити в таблиці єдиний запис, що
вказує на маршрутизатор, через який пролягає шлях до всіх цих мереж.
Такий маршрутизатор називається <b>маршрутизатором за замовчуванням</b>, а замість
номера мережі у відповідному рядку поміщається особливий запис, наприклад <i><b>default</b></i>. У
нашому прикладі таким маршрутизатором за замовчуванням для мережі <b>S5</b> є
<b>маршрутизатор 5</b>, точніше його <b>порт М5(1)</b>. Це означає, що шлях з мережі 
<b>S5</b>
майже до всіх мереж великої складеної мережі
пролягає через цей порт маршрутизатора.</p>
<p>Перед
тим як передати пакет наступному маршрутизатору,
даний маршрутизатор повинен визначити, на який з декількох
власних портів він повинен помістити даний пакет. Для цього служить третій стовпець
таблиці маршрутизації. Ще раз підкреслимо, що кожен
порт ідентифікується власною мережною адресою.</p>
<p>Деякі реалізації мережевих протоколів допускають
наявність у таблиці маршрутизації відразу декількох рядків, що відповідають тому самому адресу
мережі призначення. У цьому випадку при виборі
маршруту приймається до уваги стовпець &quot;<b>Відстань до мережі
призначення</b>&quot;. При цьому під відстанню розуміється будь-яка метрика,
використовувана відповідно до заданого в мережевому
пакеті критерію (часто зветься класом сервісу). Відстань може вимірятися <i><b>хопами</b></i>, часом проходження пакета по лініях зв'язку,
якою-небудь характеристикою надійності ліній зв'язку на даному маршруті або
іншій величині, що відображає
якість даного маршруту стосовно заданого критерію. Якщо маршрутизатор підтримує
кілька класів сервісу пакетів, то таблиця маршрутів складається й
застосовується окремо для кожного виду сервісу
(критерію вибору маршруту).</p>
<p>У табл. 5.1 відстань між мережами вимірялося хопами.
Відстань для мереж, безпосередньо підключених до портів маршрутизатора, тут
приймається рівною 0, однак у деяких
реалізаціях відлік відстаней починається з 1.</p>
<p>Наявність декількох маршрутів до одного вузла уможливлюють передачу трафіка до цього вузла паралельно по декількох каналах зв'язку,
це підвищує пропускну здатність і надійність мережі.</p>
<p>Задачу маршрутизації вирішують не тільки
проміжні вузли-маршрутизатори, але й кінцеві вузли - комп'ютери. Засоби мережевого
рівня, установлені на кінцевому вузлі, при
обробці пакета повинні, насамперед, визначити,
чи направляється він в іншу мережу або адресований якому-небудь вузлу даної мережі.
Якщо номер мережі призначення збігається з номером даної мережі,
то для даного пакета не потрібно вирішувати завдання
маршрутизації. Якщо ж номера мереж відправлення й призначення не збігаються, то маршрутизація потрібна. Таблиці маршрутизації
кінцевих вузлів повністю аналогічні таблицям
маршрутизації, що зберігається на маршрутизаторах.</p>
<p>Звернемося знову до мережі, зображеної
на мал.&nbsp;5.2. Таблиця маршрутизації для кінцевого вузла В могла б виглядати в
так (табл.&nbsp;5.2). Тут <b>MB</b> - мережева адреса порту <b>комп'ютера В</b>. На підставі цієї таблиці
кінцевий <b>вузол В</b> вибирає, на який із двох
наявних у локальній мережі <b>S3</b> маршрутизаторів
варто посилати той або інший пакет.</p>
<table border=2 cellspacing=0 cellpadding=0 width="100%">
	<caption style="text-align: left"><i><b>Таблиці 5.2. </b>Таблиця маршрутизації кінцевого вузла В</i></caption>
	<tr>
		<th valign=top>
		Номер мережі<br>
&nbsp;призначення</th>
		<th valign=top>
		Мережева адреса <br>
		наступного маршрутизатора</th>
		<th valign=top>
		Мережева адреса <br>
		вихідного порту</th>
		<th valign=top>
		Відстань до <br>
		мережі призначення</th>
	</tr>
	<tr>
		<td valign=top align="center">
		S1</td>
		<td valign=top align="center">
		М1(3)</td>
		<td valign=top>
		MB</td>
		<td valign=top align="center">
		1</td>
	</tr>
	<tr>
		<td valign=top align="center">
		S2</td>
		<td valign=top align="center">
		М1(3)</td>
		<td valign=top>
		MB</td>
		<td valign=top align="center">
		1</td>
	</tr>
	<tr>
		<td valign=top align="center">
		S3</td>
		<td valign=top align="center">
		—</td>
		<td valign=top>
		MB</td>
		<td valign=top align="center">
		0</td>
	</tr>
	<tr>
		<td valign=top align="center">
		S4</td>
		<td valign=top align="center">
		М3(1)</td>
		<td valign=top>
		MB</td>
		<td valign=top align="center">
		1</td>
	</tr>
	<tr>
		<td valign=top align="center">
		SS</td>
		<td valign=top align="center">
		М1(3)</td>
		<td valign=top>
		MB</td>
		<td valign=top align="center">
		2</td>
	</tr>
	<tr>
		<td valign=top align="center">
		S6</td>
		<td valign=top align="center">
		М3(1)</td>
		<td valign=top>
		MB</td>
		<td valign=top align="center">
		2</td>
	</tr>
	<tr>
		<td valign=top align="center">
		Default</td>
		<td valign=top align="center">
		М3(1)</td>
		<td valign=top>
		MB</td>
		<td valign=top align="center">
		—</td>
	</tr>
</table>
<p>Кінцеві вузли в ще більшому
ступені, ніж маршрутизатори, користуються прийомом маршрутизації за замовчуванням. Хоча вони
також у загальному випадку мають у своєму
розпорядженні таблицю маршрутизації, її об'єм
звичайно незначний, що пояснюється
периферійним розташуванням всіх кінцевих
вузлів. Кінцевий вузол часто взагалі працює без таблиці маршрутизації, маючи
тільки відомості про адресу маршрутизатора за
замовчуванням. При наявності одного маршрутизатора в локальній мережі цей варіант - єдино можливий
для всіх кінцевих вузлів. Але навіть при наявності декількох
маршрутизаторів у локальній мережі, коли перед
кінцевим вузлом стоїть проблема їхнього
вибору, завдання маршруту за замовчуванням часто використовується
в комп'ютерах для скорочення об'єму їхньої
таблиці маршрутизації.</p>
<p>Нижче поміщена таблиця
маршрутизації іншого кінцевого вузла складеної
мережі - <b>вузла А</b> (табл.&nbsp;5.3). Компактний вид таблиці маршрутизації відбиває
той факт, що всі пакети, що направляють із
<b>вузла А</b>, або не виходять за межі <b>мережі S12</b>,
або неодмінно проходять через <b>порт 1 маршрутизатора 17</b>. Цей маршрутизатор і
визначений у таблиці маршрутизації як
маршрутизатор за замовчуванням.</p>
<table border=1 cellspacing=0 cellpadding=0 width="100%">
	<caption style="text-align: left"><b><i>Таблиці 5.3. </i></b><i>Таблиця маршрутизації кінцевого вузла А</i></caption>
	<tr>
		<th valign=top>
		Номер мережі<br>
		призначення</th>
		<th valign=top>
		Мережева адреса <br>
		наступного маршрутизатора</th>
		<th valign=top>
		Мережева адреса <br>
		вихідного порту</th>
		<th valign=top>
		Відстань до <br>
		мережі призначення</th>
	</tr>
	<tr>
		<td valign=top align="center">
		S12 </td>
		<td valign=top align="center">
		—</td>
		<td valign=top align="center">
		МА</td>
		<td valign=top align="center">
		0</td>
	</tr>
	<tr>
		<td valign=top align="center">
		Default </td>
		<td valign=top align="center">
		М17(1) </td>
		<td valign=top align="center">
		МА </td>
		<td valign=top align="center">
		—</td>
	</tr>
</table>
<p>Ще однією
відмінністю роботи маршрутизатора й кінцевого
вузла при виборі маршруту є спосіб побудови
таблиці маршрутизації. Якщо маршрутизатори звичайно автоматично створюють
таблиці маршрутизації, обмінюючись службовою інформацією, то для кінцевих
вузлів таблиці маршрутизації часто створюються вручну адміністраторами й
зберігаються у вигляді постійних файлів на дисках.</p>
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="table1">
  <tr>
    <td width="100%" align="left" colspan="3"><hr color="#2D4C54" size="4"></td>
  </tr>
  <tr>
    <td width="33%" align="left"><a href="002.htm">Попередня</a></td>
    <td width="33%" align="center"><a href="001.htm">Перша</a></td>
    <td width="34%" align="right"><a href="004.htm">Наступна</a></td>
  </tr>
</table></body>
</html>
