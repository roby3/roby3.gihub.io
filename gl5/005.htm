<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1251">
<meta http-equiv="Content-Language" content="uk">
<link rel=Edit-Time-Data href=../tmp/5.1.5u.files/editdata.mso>
<title>5.1.5. Функції маршрутизатора</title>
</head>
<body lang=Ua>
<h3>5.1.5.
Функції маршрутизатора</h3>
<p>Основна функція маршрутизатора -
читання заголовків пакетів мережевих
протоколів, прийнятих і буферизованих по кожному порту
(наприклад, IPX, IP, AppleTalk або DECnet), і ухвалення рішення про подальший
маршрут проходження пакета по його мережевій
адресі, що включає, як правило, номер мережі й
номер вузла.</p>
<p>Функції маршрутизатора можуть
бути розбиті на 3 групи відповідно до рівнів моделі OSI (мал. 5.3).</p>
<table border="0" width="100%" id="table1">
	<tr>
		<td align="center">
<img width=545 height=680
src=images/im003.jpg v:shapes=_x0000_i1025></td>
	</tr>
	<tr>
		<td align="center">Мал. 5.3. Функціональна модель маршрутизатора</td>
	</tr>
</table>
<h4><a name=8></a>Рівень інтерфейсів</h4>
<p>На нижньому рівні маршрутизатор,
як і будь-який пристрій, підключений до мережі, забезпечує фізичний інтерфейс із середовищем передачі, включаючи узгодження рівнів
електричних сигналів, лінійне й логічне кодування, оснащення певним типом рознімання. У різних моделях
маршрутизаторів часто передбачаються різні набори фізичних інтерфейсів, що представляють собою комбінацію портів для приєднання
локальних і глобальних мереж. З кожним інтерфейсом для підключення локальної мережі нерозривно зв'язаний
певний протокол канального рівня - наприклад,
Ethernet, Token Ring, FDDI. Інтерфейси для приєднання до глобальних мереж найчастіше визначають
тільки деякі стандарт фізичного рівня, над яким у маршрутизаторі можуть
працювати різні протоколи канального рівня. Наприклад, глобальний порт може
підтримувати інтерфейс V.35, над яким можуть працювати протоколи канального
рівня: LAP-B (що використовуються у мережах Х.25), LAP-F (використовуються
у мережах frame relay), LAP-D (використовуються у мережах
ISDN). Різниця між інтерфейсами локальних і глобальних мереж
пояснюється тим, що технології локальних мереж працюють за власними стандартами фізичного
рівня, які не можуть, як правило, використовуватися
в інших технологіях, тому інтерфейс для локальної мережі
являє собою сполучення фізичного й канального рівнів і зветься по імені
відповідної технології - наприклад, інтерфейс Ethernet.</p>
<p>Інтерфейси маршрутизатора
виконують повний набір функцій фізичного й
канального рівнів по передачі кадру, включаючи одержання доступу до середовища (якщо це необхідно), формування бітових
сигналів, прийом кадру, підрахунок його
контрольної суми й передачу поля даних кадру
верхньому рівню, у випадку якщо контрольна
сума має коректне значення.</p>
<table border="0" cellpadding="0" cellspacing="1" width="100%" id="table2">
	<tr>
		<td>
<img width=36 height=35
src=images/znak.gif v:shapes=_x0000_s1026 hspace="9"></td>
		<td><i>Як і
будь-який кінцевий вузол, кожен порт
маршрутизатора має власну апаратну адресу (у
локальних мережах МАС-адресу),
по якій йому й направляються
кадри, що вимагають маршрутизації, іншими вузлами мережі.</i></td>
	</tr>
</table>
<p>Перелік фізичних інтерфейсів, які
підтримує та або інша модель маршрутизатора, є
його найважливішою споживчою характеристикою. Маршрутизатор повинен
підтримувати всі протоколи канального й фізичного рівнів, яка використовується в кожній з мереж,
до яких він буде безпосередньо приєднаний. На мал. 5.3 показана функціональна
модель маршрутизатора із чотирма портами, що реалізують наступні фізичні
інтерфейси: 10Base-T й 10Base-2 для двох портів Ethernet, UTP для Token Ring й
V.35, над яким можуть працювати протоколи LAP-B, LAP-D або LAP-F, забезпечуючи
підключення до мереж Х.25, ISDN або frame
relay.</p>
<p>Кадри, які надходять на порти маршрутизатора, після обробки
відповідними протоколами фізичного й канального рівнів, звільняються від
заголовків канального рівня. Взяті з поля даних кадру пакети передаються модулю мережевого
протоколу.</p>
<h4><a name=9></a>Рівень мережевого
протоколу</h4>
<p>Мережевий протокол у свою чергу витягає з пакета
заголовок мережевого рівня й аналізує вміст
його полів. Насамперед перевіряється контрольна
сума, і якщо пакет прийшов ушкодженим, то він
відкидається. Виконується перевірка, чи не перевищило час, що провів пакет у мережі (час життя пакета), припустимої величини. Якщо перевищило - то пакет також
відкидається. На цьому етапі вносяться коректування у вміст деяких полів,
наприклад, збільшується час життя пакета,
перераховується контрольна сума.</p>
<p>На мережевому
рівні виконується одна з найважливіших функцій маршрутизатора - фільтрація трафіка. Маршрутизатор, маючи більш
високий інтелект, ніж мости й комутатори, дозволяє задавати й може
відпрацьовувати значно більш складні правила
фільтрації. Пакет мережевого рівня, що перебуває в поле
даних кадру, для мостів/комутаторів представляється неструктурованою двійковою
послідовністю. Маршрутизатори ж, програмне забезпечення яких містить модуль мережевого
протоколу, здатні робити розбір й аналіз
окремих полів пакета. Вони оснащуються розвиненими засобами
користувацького інтерфейсу, які дозволяють адміністраторові
без особливих зусиль задавати складні правила фільтрації. Вони, наприклад,
можуть заборонити проходження в корпоративну мережу
всіх пакетів, крім пакетів, що надходять з підмереж цього ж підприємства. Фільтрація в цьому
випадку здійснюється по мережевих
адресах, і всі пакети, адреси яких не входять у дозволений діапазон,
відкидаються. Маршрутизатори, як правило, також можуть аналізувати структуру
повідомлень транспортного рівня, тому фільтри можуть не пропускати в мережу повідомлення певних
прикладних служб, наприклад служби telnet, аналізуючи поле
типу протоколу в транспортному повідомленні.</p>
<p>У випадку якщо інтенсивність
надходження пакетів вище інтенсивності, з якої вони обробляються, пакети можуть утворити
чергу. Програмне забезпечення маршрутизатора може реалізувати різні дисципліни
обслуговування черг пакетів: у порядку надходження за принципом «перший прийшов
- першим обслужений»
(First Input First Output, FIFO), випадкове раннє виявлення, коли
обслуговування йде за правилом FIFO, але при досягненні довжиною черги деякого граничного значення знову вступні
пакети відкидаються (Random Early Detection, RED), а також різні варіанти
пріоритетного обслуговування.</p>
<p>До мережевого
рівня належить основна функція маршрутизатора
- визначення маршруту пакета. По номеру мережі, взятому із
заголовка пакета, модуль мережевого протоколу знаходить у таблиці
маршрутизації рядок, що містить мережеву адресу
наступного маршрутизатора, і номер порту, на який
потрібно передати даний пакет, щоб він рухався в правильному напрямку. Якщо в таблиці
відсутній запис про мережі призначення пакета
й до того ж немає запису про маршрутизатор за
замовчуванням, то даний пакет відкидається.</p>
<p>Перед тим як передати мережеву адресу
наступного маршрутизатора на канальний рівень, необхідно перетворити його в локальну адресу тієї
технології, що використовується в мережі, що містить
наступний маршрутизатор. Для цього мережевий протокол звертається до <i>протоколу дозволу адрес. 
</i>Протоколи цього типу встановлюють
відповідність між мережевими й локальними
адресами або на підставі заздалегідь складених
таблиць, або шляхом розсилання широкомовних запитів. Таблиця відповідності
локальних адрес мережевим адресам будується окремо для кожного мережевого інтерфейсу. Протоколи дозволу
адрес займають проміжне положення між мережевим
і канальним рівнями.</p>
<p>З мережевого
рівня пакет, локальна адреса
наступного маршрутизатора й номер порту маршрутизатора передаються вниз,
канальному рівню. На підставі зазначеного номера порту здійснюється комутація з одним з інтерфейсів маршрутизатора, засобами якого виконується пакування
пакета в кадр відповідного формату. У поле
адреси призначення заголовка кадру міститься
локальна адреса наступного маршрутизатора. Готовий кадр відправляється в мережу.</p>
<h4><a name=10></a>Рівень протоколів маршрутизації</h4>
<p>Мережеві протоколи активно використовують у своїй роботі таблицю маршрутизації, але ні її
побудовою, ні підтримкою її вмісту не займаються.
Ці функції виконують протоколи маршрутизації. На підставі цих протоколів
маршрутизатори обмінюються інформацією про топологію мережі,
а потім аналізують отримані відомості, визначаючи найкращі по тим або інших критеріях
маршрути. Результати аналізу й становлять вміст
таблиць маршрутизації.</p>
<p>Крім перерахованих вище функцій,
на маршрутизатори можуть бути покладені й іншого
обов'язки, наприклад операції, пов'язані із
фрагментацією. Більш детально робота маршрутизаторів буде описана при розгляді
конкретних протоколів мережевого рівня.</p>
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="table1">
  <tr>
    <td width="100%" align="left" colspan="3"><hr color="#2D4C54" size="4"></td>
  </tr>
  <tr>
    <td width="33%" align="left"><a href="004.htm">Попередня</a></td>
    <td width="33%" align="center"><a href="001.htm">Перша</a></td>
    <td width="34%" align="right"><a href="006.htm">Наступна</a></td>
  </tr>
</table></body>
</html>
