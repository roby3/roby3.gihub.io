<html xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 6.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Language" content="uk">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<title>3.2.2. Структура кадрів LLC. Процедура з відновленням кадрів LLC2</title>

<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:Categories msdt:dt="string">Навчальний метеріал</mso:Categories>
</mso:CustomDocumentProperties>
</xml><![endif]-->
</head>

<body>

<h3>3.2.2. Структура кадрів LLC. Процедура з відновленням кадрів LLC2 </h3>
<p>По своєму призначенню всі кадри рівня LLC (в стандарті 802.2 називаються 
блоками даних — Protocol Data Unit, PDU) підрозділяються на три типи — 
інформаційні, керуючі і ненумеровані.</p>
<ul>
  <li><i>Інформаційні кадри</i>. (<i>Information</i>) призначені для передачі 
  інформації в процедурах з встановленням логічного з'єднання LLC2 і повинні 
  обов'язково містити поле інформації. В процесі передачі інформаційних блоків 
  здійснюється їхня нумерація в режимі ковзаючого вікна.</li>
  <li><i>Управляючі кадри</i> (<i>Supervisory</i>) призначені для передачі 
  команд і відповідей у процедурах з встановленням логічного з'єднання LLC2, у 
  тому числі запитів на повторну передачу перекручених інформаційних блоків.</li>
  <li><i>Ненумеровані кадри</i> (<i>Unnumbered</i>) призначені для передачі 
  ненумерованих команд і відповідей, що виконуються в процедурах без 
  встановлення логічного з'єднання передачу інформації, ідентифікацію і 
  тестування LLC-рівня, а в процедурах з встановленням логічного з'єднання LLC2 
  — встановлення і роз'єднання логічного з'єднання, а також інформування про 
  помилки.</li>
</ul>
<p>Всі типи кадрів рівня LLC мають єдиний формат:<br>
<img border="0" src="images/f3_2.gif" width="548" height="61"></p>
<b></b>
<p>Кадр LLC обрамляється двома однобайтовими полями &quot;Прапор&quot;, що мають значення 
01111110. Прапори використовуються на рівні MAC для визначення границь кадру LLC. 
Відповідно до багаторівневої структури протоколів стандартів IEEE&nbsp;802, кадр LLC 
вкладається в кадр рівня MAC: кадр Ethernet, Token Ring, FDDI і т.д. При цьому 
прапори кадру LLC відкидаються.</p>
<p>Кадр LLC містить поле даних і заголовок, яки складається з трьох полів:</p>
<ul>
  <li>адреса точки входу служби призначення (Destination Service Access Point, 
  DSAP)</li>
  <li>адреса точки входу служби джерела (Source Service Access Point, SSAP);</li>
  <li>керуюче поле (Control).</li>
</ul>
<p><i>Поле даних</i> кадру LLC призначено для передачі по мережі пакетів 
протоколів рівнів, які знаходяться вище, — мережевих протоколів IP, IPX, 
AppleTalk, DECnet, у рідких випадках — прикладних протоколів, коли ті вкладають 
свої повідомлення безпосередньо в кадри канального рівня. Поле даних може бути 
відсутнім у керуючих кадрах і деяких ненумерованих кадрах.</p>
<p><i>Адресні поля</i> DSAP і SSAP займають по 1 байту. Вони дозволяють вказати, 
яка служба верхнього рівня пересилає дані за допомогою цього кадру. Програмному 
забезпеченню вузлів мережі при одержанні кадрів канального рівня необхідно 
розпізнати, який протокол вклав свій пакет у поле даних кадру, що надійшов, щоб 
передати витягнутий з кадру пакет потрібному протоколу верхнього рівня для 
наступної обробки. Для ідентифікації цих протоколів вводяться так звані адреси 
точки входу служби (Service Access Point, SAP). Значення адрес SAP приписуються 
протоколам у відповідності зі стандартом 802.2. Наприклад, для протоколу IP 
значення SAP дорівнює 0х6, для протоколу NetBIOS - 0xF0. Для одних служб 
визначена тільки одна точка входу і, відповідно, тільки один SAP, а для інших — 
декілька, коли адреси DSAP і SSAP збігаються. Наприклад, якщо в кадрі LLC 
значення DSAP і SSAP містять код протоколу IPX, то обмін кадрами здійснюється 
між двома IPX-модулями, які виконуються в різних вузлах. Але в деяких випадках у 
кадрі LLC вказуються DSAP і SSAP, які розрізняються . Це можливо тільки в тих 
випадках, коли служба має кілька адрес SAP, що може бути використано протоколом 
вузла відправника в спеціальних цілях, наприклад для повідомлення вузла 
одержувача про перехід протоколу-відправника в деякий специфічний режим роботи. 
Цією властивістю протоколу LLC часто користується протокол NetBEUI. </p>
<p><i>Поле керування</i> (1 чи 2 байти) має складну структуру при роботі в режим 
LLC2 і досить просту структуру при роботі в режимі LLC1 (мал. 3.2).</p>
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber1">
  <tr>
    <td width="100%" align="center">
    <img border="0" src="images/m3_2.gif" width="498" height="113"></td>
  </tr>
  <tr>
    <td width="100%" align="center">Мал. 3.2. Структура поля керування</td>
  </tr>
</table>
<p>В режимі LLC1 використовується тільки один тип кадру — ненумерований. У цього 
кадрі поле керування має довжину в один байт. Усі підполя поля керування 
ненумерованих кадрів приймають нульові значення, так що значимими залишаються 
тільки перші два біти поля, що використовуються як ознака типу кадру. 
Враховуючи, що в протоколі Ethernet при записі реалізований зворотний порядок 
біт у байті, то запис поля керування кадру LLC1, вкладеного в кадр протоколу 
Ethernet, має значення 0х03 (тут і далі префікс 0х позначає шістнадцяткове 
представлення). </p>
<p>У режимі LLC2 використовуються всі три типи кадрів. У цьому режимі кадри 
поділяються на команди і відповіді на ці команди. Біт P/F (Poll/Final) має 
наступне значення: у командах він називається битому Poll і вимагає, щоб на 
команду була дана відповідь, а у відповідях він називається битому Final і 
говорить про те, що відповідь складається&nbsp;&nbsp; з одного кадру.&nbsp; 
Ненумеровані кадри використовуються на початковій стадії взаємодії двох вузлів, 
а саме стадії встановлення з'єднання по протоколу LLC2.</p>
<p>Поле <b>М</b> ненумерованих кадрів визначає кілька типів команд, якими 
користуються два вузли на етапі встановлення з'єднання. Нижче наведені приклади 
деяких команд.</p>
<ul>
  <li><i>Встановити збалансований асинхронний розширений режим</i> (<i>SABME</i>). 
  Ця команда є запитом на встановлення з'єднання. Вона є однією з команд повного 
  набору команд такого роду протоколу HDLC. Розширений режим означає 
  використання двубайтних полів керування для кадрів інших двох типів.</li>
  <li><i>Ненумероване підтвердження</i> (<i>UA</i>). Служить для підтвердження 
  встановлення чи розриву з'єднання.</li>
  <li><i>Розрив з'єднання</i> (<i>REST</i>). Запит на розрив з'єднання.</li>
</ul>
<p>Після встановлення з'єднання дані і позитивні квитанції починають 
передаватися в інформаційних кадрах. Логічний канал протоколу LLC2 є дуплексним, 
так що дані можуть передаватися в обох напрямках. Якщо потік дуплексний, то 
позитивні квитанції на кадри також доставляються в інформаційних кадрах. Якщо ж 
потоку кадрів у зворотному напрямку немає чи потрібно передати негативну 
квитанцію, то використовуються супервізорі кадри.</p>
<p>В інформаційних кадрах існує поле <b>N(S)</b> для вказівки номера 
відправленого кадру, а також поле <b>N(R</b>) для вказівки номера кадру, що 
приймач очікує одержати від передавача наступним. При роботі протоколу LLC2 
використовується ковзаюче вікно розміром у 127 кадрів, а для їхньої нумерації 
циклічно використовується 128 чисел, від 0 до 127.</p>
<p>Приймач завжди пам'ятає номер останнього кадру, прийнятого від передавача, і 
підтримує перемінну з зазначеним номером кадру, що він очікує прийняти від 
передавача наступним. Позначимо його через <b>V(R)</b>. Саме це значення 
передається в поле <b>N(R)</b> кадру, що посилається передавачу. Якщо у 
відповідь на цей кадр приймач приймає кадр, у якому номер посланого кадру <b>
N(S)</b> збігається з номером очікуваного кадру <b>V(R)</b>, то такий кадр 
вважається коректним (якщо, звичайно, коректна його контрольна сума). Якщо 
приймач приймає кадр із номером <b>N(S)</b>, який не співпадає з <b>V(R)</b>, то 
цей кадр відкидається і посилається негативна квитанція&nbsp; <i>Відмовлення</i> 
(<i>REJ</i>) з номером <b>V(R)</b>. При прийомі негативної квитанції передавач 
зобов'язаний повторити передачу кадру з номером <b>V(R)</b>, а також усіх кадрів 
з більшими номерами, що він уже встиг відіслати, користаючись механізмом вікна в 
127 кадрів.</p>
<p>До складу супервізорових кадрів входять наступні:</p>
<ul>
  <li><i>Відмовлення</i> (REJect);</li>
  <li><i>Приймач не готовий</i> (<i>Receiver Not Ready, RNR</i>);</li>
  <li><i>Приймач готовий</i> (<i>Receiver Ready, RR</i>).</li>
</ul>
<p>Команда <b>RR</b> з номером <b>N(R)</b> часто використовується як позитивна 
квитанція, коли потік даних від приймача до передавача відсутній, а команда <b>
RNR</b> — для уповільнення потоку кадрів, які надходять на приймач. Це може бути 
необхідно, якщо приймач не встигає обробити потік кадрів, які надсилаються йому 
з великою швидкістю за рахунок механізму вікна. Одержання кадру <b>RNR</b> 
вимагає від передавача повного припинення передачі, до одержання кадру <b>RR</b>. 
За допомогою цих кадрів здійснюється керування потоком даних, що особливо 
важливо для мереж, що комутируються, у яких немає поділюваного середовища, що 
автоматично гальмує роботу передавача за рахунок того, коли новий кадр не можна 
передати, поки приймач не закінчив прийом попереднього.</p>
<h2>Висновки</h2>
<ul>
  <li>Протокол LLC забезпечує для технологій локальних мереж потрібну якість 
  транспортної служби, передаючи свої кадри&nbsp; дейтаграмним способом або за 
  допомогою процедур з встановленням з'єднання і відновленням кадрів.</li>
  <li>LLC надає верхнім рівням три типи процедур:<ul>
    <li>процедуру без встановлення з'єднання і без підтвердження;</li>
    <li>процедуру з встановленням з'єднання і підтвердженням;</li>
    <li>процедуру без встановлення з'єднання, але з підтвердженням.</li>
  </ul>
  </li>
  <li>Логічний канал протоколу LLC2 є дуплексним, так що дані можуть 
  передаватися в обох напрямках.</li>
  <li>Протокол LLC у режимі з встановленням з'єднання використовує алгоритм 
  ковзаючого вікна.</li>
  <li>Протокол LLC за допомогою керуючих кадрів має можливість регулювати потік 
  даних, що надходять від вузлів мережі. Це особливо важливо для мереж, які 
  комутируються, у яких немає поділюваного середовища, що автоматично гальмує 
  роботу передавача при високому завантаженні мережі.</li>
</ul>
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber4">
  <tr>
    <td width="100%" align="left" colspan="3"><hr color="#2D4C54" size="4"></td>
  </tr>
  <tr>
    <td width="33%" align="left"><a href="004.htm">Попередня</a></td>
    <td width="33%" align="center"><a href="001.htm">Перша</a></td>
    <td width="34%" align="right"><a href="006.htm">Наступна</a></td>
  </tr>
</table>

</body>

</html>
