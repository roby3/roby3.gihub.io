<html xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 6.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Language" content="uk">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<title>3.3.3. Формати кадрів технології Ethernet</title>

<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:Categories msdt:dt="string">Навчальний метеріал</mso:Categories>
</mso:CustomDocumentProperties>
</xml><![endif]-->
</head>

<body>

<h3>3.3.3. Формати кадрів технології Ethernet </h3>
<p>Стандарт технології Ethernet, описаний у документі IEEE&nbsp;802.3, дає опис 
єдиного формату кадру рівня MAC. Тому що в кадр рівня MAC повинний вкладатися 
кадр рівня LLC, описаний у документі IEEE&nbsp;802.2, то по стандартах IEEE у мережі 
Ethernet може використовуватися тільки єдиний варіант кадру канального рівня, 
заголовок якого є комбінацією заголовків MAC і LLC підрівнів.</p>
<p>Проте на практиці в мережах Ethernet на канальному рівні використовуються&nbsp; 
кадри 4-х різних форматів (типів). Це пов'язано з тривалою історією розвитку 
технології Ethernet, що нараховує період існування до прийняття стандартів IEEE 
802, коли підрівень LLC не виділявся з загального протоколу і, відповідно, 
заголовок LLC не застосовувався.</p>
<p>Консорціум трьох фірм Digital, Intel і Xerox у 1980 році подав на розгляд 
комітету 802.3 свою фірмову версію стандарту Ethernet (у який був, природно, 
описаний визначений формат кадру) як проект міжнародного стандарту, але комітет 
802.3 прийняв стандарт, що відрізняється в деяких деталях від пропозиції DIX. 
Відмінності стосувалися і формату кадру, що породило існування двох різних типів 
кадрів у мережах Ethernet.</p>
<p>Ще один формат кадру з'явився в результаті зусиль компанії Novell по 
прискоренню роботи свого стека протоколів у мережах Ethernet.</p>
<p>І нарешті, четвертий формат кадру став результатом діяльності комітету 802.2 
по приведенню попередніх форматів кадрів до деякого загального стандарту.</p>
<p>Розходження у форматах кадрів можуть приводити до несумісності в роботі 
апаратури і мережного програмного забезпечення, розрахованого на роботу тільки з 
одним стандартом кадру Ethernet. Однак сьогодні практично всі мережні адаптери, 
драйвери мережних адаптерів, мости/комутатори і маршрутизатори вміють працювати 
з усіма використовуваними на практиці форматами кадрів технології Ethernet, 
причому розпізнавання типу кадру виконується автоматично.</p>
<p>Нижче наводиться опис усіх чотирьох типів кадрів Ethernet (тут під кадром 
розуміється весь набір полів, що відносяться до канального рівня, тобто поля MAC 
і LLC рівнів). Той самий тип кадру може мати різні назви, тому нижче для кожного 
типу кадру приведене по декілька найбільш вживаних назв:</p>
<ul>
  <li>кадр 802.3/LLC (кадр 802.3/802.2 чи кадр Novell 802.2);</li>
  <li>кадр Raw 802.3 (чи кадр Novell 802.3);</li>
  <li>кадр Ethernet DIX (чи кадр Ethernet II);</li>
  <li>кадр Ethernet SNAP.</li>
</ul>
<p>Формати всіх цих чотирьох типів кадрів Ethernet приведені на мал. 3.6.</p>
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber1">
  <tr>
    <td width="100%" align="center">
    <img border="0" src="images/m3_6.gif" width="437" height="487"></td>
  </tr>
  <tr>
    <td width="100%" align="center">Мал.3.6. Формати кадрів Ethernet</td>
  </tr>
</table>
<h4>Кадр 802.3/LLC</h4>
<p>Заголовок кадру 802.3/LLC є результатом об'єднання полів заголовків кадрів, 
визначених у стандартах IEEE&nbsp;802.3 і 802.2.Стандарт&nbsp;802.3 визначає вісім полів 
заголовка (мал.&nbsp;3.6; поле преамбули і початковий обмежувач кадру на малюнку не 
показані).</p>
<ul>
  <li><i>Поле преамбули</i> (<i>Preamble</i>) складається із семи синхронізуючих 
  байт 10101010. При манчестерському кодуванні ця комбінація представляється у 
  фізичному середовищі періодичним хвильовим сигналом з частотою 5&nbsp;Мгц.</li>
  <li><i>Початковий обмежувач кадру</i> (<i>Start-of-frame-delimiter, SFD</i>) 
  складається з одного байта 10101011. Поява цієї комбінації біт є вказівкою на 
  те, що наступний байт — це перший байт заголовка кадру.</li>
  <li><i>Адреса призначення</i> (<i>Destination Address, DA</i>) може бути 
  довжиною 2 чи 6 байт. На практиці завжди використовуються адреси з 6&nbsp;байт. 
  Перший біт старшого байта адреси призначення є ознакою того, є адреса 
  індивідуальна чи групова. Якщо він дорівнює 0, то адреса є <i>індивідуальною</i> 
  (<i>unicast</i>), a якщо 1, те це <i>групова адреса</i> (<i>multicast</i>). 
  Групова адреса може призначатися усім вузлам мережі чи ж визначеній групі 
  вузлів мережі. Якщо адреса складається з всіх одиниць, тобто має 
  шістнадцяткове представлення 0xFFFFFFFFFFFF, то вона призначається всім вузлам 
  мережі і називається <i>широкомовною адресою</i> (<i>broadcast</i>). В інших 
  випадках групова адреса зв'язана тільки з тими вузлами, що сконфігуровані 
  (наприклад, привласнені) як члени групи, номер якої зазначений у груповій 
  адресі. Другий біт старшого байта адреси визначає спосіб призначення адреси — 
  централізований чи локальний. Якщо цей біт дорівнює 0 (що буває майже завжди в 
  стандартній апаратурі Ethernet), то адреса призначена централізовано, за 
  допомогою комітету 11111. Комітет ILEE розподіляє між виробниками устаткування 
  так звані <i>організаційно унікальні ідентифікатори</i> (<i>Organizationally 
  Unique Identifier, OUІ</i>). Цей ідентифікатор міститься в 3 старших байтай 
  адреси&nbsp; (наприклад, ідентифікатор 000081 визначає компанію Bay Networks). 
  За унікальність молодших 3-х байт адреси&nbsp; відповідає виробник 
  устаткування. Двадцять чотири біти, що підводяться виробнику для адресації 
  інтерфейсів його продукції, дозволяють випустити 16 мільйонів інтерфейсів під 
  одним ідентифікатором організації. Унікальність адрес,&nbsp; що централізовано 
  розподіляються, поширюється на всі основні технології локальних мереж - 
  Ethernet, Token&nbsp;Ring, FDDI і т.д.</li>
</ul>
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber4">
  <tr>
    <td width="100%" bgcolor="#2D4C54"><b><font color="#3399FF">УВАГА !</font></b></td>
  </tr>
  <tr>
    <td width="100%" bgcolor="#D1F0F8">В стандартах IEEE Ethernet молодший біт 
    байта зображується в самій лівій позиції поля, а старший біт -у самій 
    правій. Цей нестандартний спосіб відображення порядку біт у байті відповідає 
    порядку передачі біт у лінію зв'язку передавачем Ethernet. У стандартах 
    інших організацій, наприклад RFC IETF, ITU-T, ISO, використовується 
    традиційне представлення байта, коли молодший біт вважається самим правим 
    бітом байта, а старший - самим лівим. При цьому порядок проходження байтів 
    залишається традиційним. Тому при читанні стандартів, опублікованих цими 
    організаціями, а також читанні даних, відображуваних на екрані операційною 
    системою чи аналізатором протоколів, значення кожного байта кадру Ethernet 
    потрібно дзеркально відобразити, щоб одержати правильне представлення про 
    значення розрядів цього байта відповідно до документів IEEE. Наприклад, 
    групова адреса, наявна у нотації IEEE має вигляд<br>
    <nobr>1000 0000 0000 0000 10100111 1111 0000 0000 0000 0000 0000</nobr><br>
    чи в шістнадцятковому записі <nobr>80-00-A7-FO-00-00</nobr>, буде, швидше за 
    все, відображена аналізатором протоколів у традиційному виді як <nobr>
    01-00-5E-OF-00-00</nobr>.</td>
  </tr>
</table>
<ul>
  <li><i>Адреса джерела</i> (<i>Source Address, SA</i>) — це 2-чи 6-байтовое 
  поле, що містить адресу вузла — відправника кадру. Перший біт адреси завжди 
  має значення 0.</li>
  <li><i>Довжина</i> (<i>Length, L</i>) — 2-байтовое поле, що визначає довжину 
  полючи даних у кадрі.</li>
  <li><i>Поле даних</i> (<i>Data</i>) може містити від 0 до 1500 байт. Але якщо 
  довжина нуля менше 46 байт, то використовується наступне поле — поле 
  заповнення, — щоб доповнити кадр до мінімально припустимого значення в 46 
  байт.</li>
  <li><i>Поле заповнення</i> (<i>Padding</i>) складається з такої кількості байт 
  заповнювачів, що забезпечує мінімальну довжину поля даних у 46 байт. Це 
  забезпечує коректну роботу механізму виявлення колізій. Якщо довжина поля 
  даних достатня, то поле заповнення в кадрі не з'являється.</li>
  <li><i>Поле контрольної суми</i> (<i>Frame Check Sequence. FCS</i>) 
  складається з 4 байт, вміщуючих контрольну суму. Це значення обчислюється за 
  алгоритмом <i>CRC-32</i>. Після одержання кадру робоча станція виконує власне 
  обчислення контрольної суми для цього кадру, порівнює отримане значення зі 
  значенням поля контрольної суми і, таким чином, визначає, чи не перекручений 
  отриманий кадр.</li>
</ul>
<p>Кадр 802.3 є кадром МАС-підрівня тому у відповідності до стандарту 802.2 в 
його поле даних вкладається кадр підрівня LLC з вилученими прапорами початку і 
кінця кадру. Формат кадру LLC був описаний вище. Тому що кадр LLC має заголовок 
довжиною 3 (у режимі I.LC1) чи 4 байт (у режимі LLC2), то максимальний розмір 
поля даних зменшується&nbsp; до 1497 чи 1496 байт&nbsp;</p>
<h4>Кадр Raw 802.3/Novell 802.3</h4>
<p><i>Кадр Raw 802.3</i>,&nbsp; також званий кадром <i>Novell 802.3</i>, 
представлений на мал. 3.6. З малюнка видно, що це кадр підрівня MAC стандарту 
802.3, але без вкладеного кадру підрівня LLC. Компанія Novell довгий час не 
використовувала службові поля кадру LLC у своїй операційній системі NetWare 
через відсутність необхідності ідентифікувати тип інформації, вкладеної в поле 
даних, — там завжди знаходився пакет протоколу IPX, довгий час був єдиним 
протоколом мережного рівня в ОС NetWare.</p>
<p>Тепер, коли необхідність ідентифікації протоколу верхнього рівня з'явилася, 
компанія Novell стала використовувати можливість інкапсуляції в кадр підрівня 
MAC кадру LLC, тобто використовувати стандартні кадри 802.3/LLC. Такий кадр 
компанія позначає тепер у своїх операційних системах як кадр 802.2, хоча він є 
комбінацією заголовків 802.3 і 802.2.</p>
<h4>Кадр Ethernet DIX/Ethernet II</h4>
<p><i>Кадр Ethernet DIX</i>, який також зветься&nbsp; <i>кадром Ethernet II</i>, 
має структуру (див. мал. 3.6), що збігається зі структурою кадру Raw&nbsp;802.3. 
Однак 2-байтовое поле <i>Довжина</i> (<i>L</i>) кадру Raw&nbsp;802.3 у кадрі Ethernet&nbsp;DIX 
використовується в якості поля типу протоколу. Це поле, що тепер одержало назву
<i>Type</i> (<i>Т</i>) чи <i>EtherType</i>, призначено для тих ж цілей, що і 
поля DSAP і SSAP кадру LLC — для вказівки типу протоколу верхнього рівня, що 
вклали в свій пакет у поле даних цього кадру.</p>
<p>У той час як коди протоколів в полях SAP мають довжину в один байт, у поле 
Type для коду протоколу виділяються 2 байти. Тому той самий протокол у поле SAP 
і поле Type буде кодуватися в загальному випадку різними числовимиз наченнями. 
Наприклад, протокол IP має код 2048<sub>10</sub>; (0х0800) для поля EtherType і 
значення 6 для поля SAP. Значення кодів протоколів для поля EtherType з'явилися 
раніш значень SAP, тому що фірмова версія Ethernet&nbsp;DIX існувала до появи 
стандарту 802.3, і вчасно поширення устаткування 802.3 уже стали стандартами 
де-факто для багатьох апаратних і програмних продуктів. Тому що структури кадрів 
Ethernet&nbsp;DIX і Raw&nbsp;802.3 збігаються, те поле довжини/типу часто в документації 
позначають як поле L/T.</p>
<h4>Кадр Ethernet SNAP</h4>
<p>Для усунення різнобою в кодуваннях типів протоколів, повідомлення яких 
вкладені в поле даних кадрів Ethernet, комітетом 802.2 були проведені робота з 
подальшої стандартизації кадрів Ethernet. У результаті з'явився кадр Ethernet&nbsp;SNAP 
(SNAP — SubNetwork Access Protocol, протокол доступу до підмереж). Кадр Ethernet 
SNAP (див. мал. 3.6) являє собою розширення кадру 802.3/LLC за рахунок уведення 
додаткового заголовка протоколу SNAP, що складає з двох полів: OUI і Type. Поле 
Type складається з 2-х байт і повторює по форматі і призначенню поле Type кадру 
Ethernet&nbsp;II (тобто в ньому використовуються ті ж значення кодів протоколів). 
Поле OUI (Organizationally Unique Identifier) визначає ідентифікатор 
організації, що контролює коди протоколів у поле Type. За допомогою заголовка 
SNAP досягнута сумісність з кодами протоколів у кадрах Ethernet&nbsp;II, а також 
створена універсальна схема кодування протоколів. Коди протоколів для технологій 
802 контролює IEEE, що має OUI, рівний 000000. Якщо в майбутньому будуть 
потрібні інші коди протоколів для якої-небудь нової технології, для цього досить 
вказати інший ідентифікатор організації, що призначає ці коди, а старі значення 
кодів залишаться в силі&nbsp; (у сполученні з іншим ідентифікатором OUI).</p>
<p>Тому що SNAP являє собою протокол, вкладений в протокол LLC, то в полях DSAP 
і SSAP записується код 0хАА, відведений для протоколу SNAP. Поле Control 
заголовка LLC встановлюється в 0х03, що відповідає використанню ненумерованих 
кадрів.</p>
<p>Заголовок SNAP є доповненням до заголовка LLC. тому він припустимий не тільки 
в кадрах Ethernet, але й у кадрах протоколів інших технологій 802. Наприклад, 
протокол IP завжди використовує структуру заголовків LLC/SNAP при інкапсуляції в 
кадри всіх протоколів локальних мереж: FDDI, Token&nbsp;Ring, 100VG-AnyLAN, Ethernet, 
Fast&nbsp;Ethernet, Gigabit&nbsp;Ethernet.</p>
<p>При передачі пакетів IP через мережі Ethernet, Fast&nbsp;Ethernet і Gigabit&nbsp;Ethernet 
протокол IP використовує кадри Ethernet&nbsp;DIX.</p>
<h4>Використання різних типів кадрів Ethernet</h4>
<p>Автоматичне розпізнавання типів кадрів Ethernet виконується досить нескладно. 
Для кодування типу протоколу в полі EtherType вказуються значення, що 
перевищують значення максимальної довжини нуля даних, рівне 1500, тому кадри 
Ethernet&nbsp;ІІ легко відрізнити від інших типів кадрів за значенням поля L/T. 
Подальше розпізнавання типу кадру проводиться по наявності чи відсутності полів 
LLC. Поля LLC можуть бути відсутніми тільки в тому випадку, якщо за полем 
довжини йде початок пакета IPX, а саме 2-байтовое поле контрольної суми пакета, 
що завжди заповнюється одиницями, що дає значення в 255 байт. Ситуація, коли 
поля DSAP і SSAP одночасно містять такі значення, виникнути не може, тому 
наявність двох байт 255 говорить про те, що це кадр Raw&nbsp;802.3. В інших випадках 
подальший аналіз проводиться в залежності від значень полів DSAP і SSAP. Якщо 
вони дорівнюють 0хАА, то це кадр Ethernet&nbsp;SNAP, а якщо ні, то 802.3/LLC.</p>
<p>У табл. 3.2 приведені дані про те, які типи кадрів Ethernet звичайно 
підтримують реалізації популярних протоколів мережного рівня.</p>
<table BORDER="0" CELLSPACING="3" WIDTH="100%" cellpadding="0">
  <caption style="text-align: left">Таблиця 3.2. Типи кадрів Ethernet, що 
  підтримують реалізації популярних протоколів мережного рівня</caption>
  <tr>
    <td valign="top" colspan="2"><hr color="#2D4C54" size="4"></td>
  </tr>
  <tr>
    <th valign="top" nowrap align="left">Тип кадру</th>
    <th valign="top" nowrap align="left">Мережеві протоколи</th>
  </tr>
  <tr>
    <td valign="top" colspan="2"><hr color="#2D4C54" size="4"></td>
  </tr>
  <tr>
    <td valign="top" nowrap>Ethernet II</td>
    <td valign="top">IPX, IP, AppleTalk Phase I</td>
  </tr>
  <tr>
    <td valign="top" nowrap>Ethernet 802.3</td>
    <td valign="top">&nbsp;IPX</td>
  </tr>
  <tr>
    <td valign="top" nowrap>&nbsp;Ethernet 802.2</td>
    <td valign="top">&nbsp;IPX, FTAM</td>
  </tr>
  <tr>
    <td valign="top" nowrap>Ethernet SNAP</td>
    <td valign="top">IPX, IP, AppleTalk, Phase II</td>
  </tr>
  <tr>
    <td valign="top" colspan="2"><hr color="#2D4C54" size="1"></td>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber5">
  <tr>
    <td width="100%" align="left" colspan="3"><hr color="#2D4C54" size="4"></td>
  </tr>
  <tr>
    <td width="33%" align="left"><a href="008.htm">Попередня</a></td>
    <td width="33%" align="center"><a href="001.htm">Перша</a></td>
    <td width="34%" align="right"><a href="010.htm">Наступна</a></td>
  </tr>
</table>

</body>

</html>
