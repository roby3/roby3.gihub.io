<html xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">

<head>
<meta http-equiv="Content-Language" content="uk">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<title>3.4.3. Формати кадрів Token Ring</title>

<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:Categories msdt:dt="string">Навчальний метеріал</mso:Categories>
</mso:CustomDocumentProperties>
</xml><![endif]-->
</head>
<body>
<h3>3.4.3. Формати кадрів Token Ring</h3>
<p>У Token Ring існують три різних формати кадрів:</p>
<ul>
  <li>маркер;</li>
  <li>у кадр даних;</li>
  <li>послідовність, що перериває.</li>
</ul>
<h4>Маркер</h4>
<p>Кадр маркера складається з трьох полів,
кожне довжиною в один байт</p>
<ul>
  <li><i>Початковий обмежник</i> (<i>Start Delimiter, SD</i>) з'являється
  на початку маркера, а також на початку будь-якого
  кадру, що проходить по мережі. Поле являє
  собою наступну унікальну послідовність
  символів манчестерського коду: <b>JK0JK000</b>. Тому
  початковий обмежник не можна поплутати ні
  з якою бітовою послідовністю усередині
  кадру.</li>
  <li><i>Керування доступом</i> (<i>Access Control</i>) складається
  з чотирьох підполів: <b>РРР</b>, <b>Т</b>, <b>М</b> и <b>RRR</b>, де <b>РРР</b> —
  біти пріоритету, <b>Т</b> — біт маркера, <b>М</b> — біт
  монітора, <b>RRR</b> – резервні біти пріоритету.
  Біт <b>Т</b>, встановлений у <b>1</b>, вказує на те, що
  даний кадр є маркером доступу. Біт монітора
  встановлюється в <b>1</b> активним монітором і в <b>0</b>
  будь-якою іншою станцією, що передає  маркер чи кадр. Якщо активний монітор бачить  маркер 
  чи кадр, що
  містить біт монітора зі значенням <b>1</b>, то
  активний монітор знає, що цей  кадр
  чи маркер вже один раз обійшов кільце і не був
  оброблений станціями. Якщо це кадр, то він
  видаляється з кільця. Якщо це маркер, то
  активний монітор передає його далі по кільцю.
  Використання полів пріоритетів буде
  розглянуто нижче.</li>
  <li><i>Кінцевий обмежник</i> (<i>End Delimeter</i>, <i>ED</i>) — останнє
  поле маркера. Так само як і поле
  початкового обмежника, це поле містить унікальну
  послідовність манчестерських кодів <b>JK1JK1</b>, а
  також дві одно бітових ознаки: <b>I</b> і <b>Е</b>. Ознака
  <b>I</b> (<i>Intermediate</i>) показує, чи є кадр останнім у
  серії кадрів (І=0) чи проміжним (І=1). Ознака
  <b>Е</b> (<i>Error</i>) — це ознака помилки. Він встановлюється
  в <b>0</b> станцією-відправником, і будь-яка станція
  кільця, через яку проходить кадр, повинна
  встановити цю ознаку в <b>1</b>, якщо вона знайде
  помилку по контрольній  сумі чи іншу
  некоректність кадру.</li>
</ul>
<h4>Кадр даних і перекриваюча послідовність</h4>
<p>Кадр даних включає ті ж три полів, що і
маркер, і має крім них ще кілька додаткових
полів. Таким чином, кадр даних складається з
наступних полів:</p>
<ul>
  <li>початковий обмежник (Start Delimiter, SD);</li>
  <li>керування кадром (Frame Control, EC);</li>
  <li>адреса призначення (Destination Address, DA);</li>
  <li>адреса джерела( Source Address, SA)</li>
  <li>дані (INFO);</li>
  <li>контрольна сума (Frame Check Sequence,
  PCS);</li>
  <li>кінцевий обмежник (End Delimeter, ED);</li>
  <li>статус кадру (Frame Status, FS).</li>
</ul>
      <p>Кадр даних може переносити або службові
      дані для керування кільцем (дані МАС-рівня),
      або користувацькі дані (LLC-рівня).
      Стандарт Token Ring визначає 6 типів керуючих
      кадрів МАС-рівня. Поле <b>FC</b> визначає тип
      кадру (MAC чи LLC), і якщо він визначений як
      MAC, те поле&nbsp; також вказує, який із шести типів кадрів
      представлений даним кадром.</p>
      <p>Призначення цих шести типів кадрів
      описано нижче.</p>
<ul>
  <li>Щоб упевнитися, що її адреса унікальна,
    станція, коли вперше приєднується до кільця,
    посилає кадр <i>Тест дублювання адреси</i> (<i>Duplicate
    Address Test, DAT</i>).</li>
  <li>Щоб повідомити іншим станціям, що він
    працездатний, активний монітор періодично
    посилає в кільце кадр <i>Існує активний
    монітор</i> (<i>Active Monitor Present, AMP</i>).</li>
  <li>Кадр <i>Існує резервний монітор</i> (<i>Standby Monitor
    Present, SMP</i>) відправляється будь-якою станцією,
    що не є активним монітором.</li>
  <li>Резервний монітор відправляє кадр <i>Маркер
    заявки</i> (<i>Claim Token, CT</i>), коли підозрює, що
    активний монітор відмовив, потім резервні
    монітори домовляються між собою, який з
    них стане новим активним монітором.</li>
  <li>Станція відправляє кадр <i>Сигнал</i> (<i>Beacon, BCN</i>)
    у випадку виникнення серйозних мережних
    проблем, таких як обрив кабелю,
    виявлення станції, що передає кадри без
    чекання маркера, вихід станції з ладу.
    Визначаючи, яка станція відправляє кадр
    сигналу, що діагностує програма (її існування
    і функції не визначаються стандартами Token
    Ring) може локалізувати проблему. Кожна
    станція періодично передає кадри <b>BCN</b> доти,
    поки не прийме кадр <b>BCN</b> від свого попереднього
    (NAUN) сусіда. У результаті в кільці тільки
    одна станція продовжує передавати кадри
    <b>BCN</b> — та, у якої маються проблеми з
    попереднім сусідом. У мережі Token Ring кожна
    станція знає МАС-адресу свого
    попереднього сусіда, тому <i>Beacon</i>-процедура
    приводить до виявлення адреси некоректно
    працюючої станції.</li>
  <li>Кадр <i>Очищення</i> (<i>Purge, PRG</i>) використовується
    новим активним монітором для того, щоб
    перевести всі станції у вихідний стан і
    очистити кільце від всіх раніше посланих
    кадрів.</li>
</ul>
<p>У стандарті 802.5 використовуються адреси
тієї ж структури, що й у стандарті 802.3.
Адреси призначення і джерела можуть мати
довжину або 2, або 6 байтів. Перший біт адреси
призначення визначає групова чи індивідуальна
адреса як для 2-байтових, так і для 6-байтових
адрес. Другий біт у 6-байтових адресах
говорить про те, призначена адреса чи
локально глобальна. Адреса, що складається
з всіх одиниць, є широкомовною.</p>
<p>Адреса джерела має той же розмір і
формат, що й адреса призначення. Однак
ознака групової адреси використовується
в ньому особливим способом. Тому що
адреса джерела не може бути груповою, то
наявність одиниці в цьому розряді
говорить про те, що в кадрі мається спеціальне
<i>поле маршрутної інформації</i> (<i>Routing Information Field,
RIF</i>). Ця інформація потрібно при
роботі мостів, що зв'язують декілька кілець Token Ring, у режимі маршрутизації від джерела.</p>
<p>Поле даних <b>INFO</b> кадру може містити дані
одного з описаних керуючих кадрів рівня MAC
чи користувалцькі дані, упаковані в кадр
рівня LLC. Це поле, як уже відзначалося, не має
визначеної стандартом максимальної
довжини, хоча існують практичні обмеження
на його розмір, засновані на тимчасових співвідношеннях
між часом утримання маркера і часом
передачі кадру. Поле статусу <b>FS</b> має довжину 1&nbsp;байт і
містить 4 резервних біти і 2 підполя, біт розпізнавання адреси <b>А</b> і біт копіювання
кадру <b>С</b>. Тому що це поле не супроводжується
сумою, що обчислюється, <b>CRC</b>, ті
використовувані біти для надійності
дублюються: поле статусу <b>FS</b> має вид АСххАСхх.
Якщо біт розпізнавання адреси не
встановлений під час одержання кадру, це
означає, що станція призначення більше не є
присутньою в мережі (можливо, унаслідок
неполадок, а можливо, станція знаходиться в
іншому кільці, зв'язаному з даним за
допомогою моста). Якщо обидва біти впізнання
адреси і копіювання кадру встановлений і
біт виявлення помилки також встановлений, то
вихідна станція знає, що помилка трапилася
після того, як цей кадр був коректно отриманий.</p>
<p><i>Послідовність, що перериває,</i> складається
з двох байтів, які містять початковий і кінцевий
обмежники. Послідовність, що перериває,
може з'явитися в будь-якім місці потоку
бітів і сигналізує про те, що поточна
передача  кадру чи маркера скасовується.</p>
<h4>Пріоритетний доступ до кільця</h4>
<p>Кожен кадр  даних чи маркер має пріоритет,
встановлюваний бітами пріоритету (значення
від <b>0</b> до <b>7</b>, причому <b>7</b> — найвищий пріоритет).
Станція може скористатися маркером, якщо тільки
в неї є кадри для передачі з пріоритетом, який дорівнює
чи більше, ніж пріоритет маркера. Мережевий
адаптер станції з кадрами, у яких пріоритет
нижче, ніж пріоритет маркера, не може
захопити маркер але може помістити найбільший пріоритет
своїх передачі кадрів, що очікують, є
резервні біти маркера, але тільки в тому
випадку, якщо записаний у резервних бітах
пріоритет нижче його власного. В результаті
у резервних бітах пріоритету встановлюється
найвищий пріоритет станції, яка намагається
одержати доступ до кільця, але не може цього
зробити через високий пріоритет маркера.</p>

<p>Станція, що зуміла захопити маркер,
передає свої кадри з пріоритетом маркера, а
потім передає маркер наступному сусіду. При
цьому вона переписує значення
резервного пріоритету в поле пріоритету
маркера, а резервний пріоритет зводиться до
нуля. Тому при наступному проході маркера
по кільцю його захопить станція, що має
найвищий пріоритет. При ініціалізації кільця основний і
резервний пріоритет маркера
встановлюються в <b>0</b>.</p>

<p>Хоча механізм пріоритетів у технології Token Ring мається, але він починає працювати тільки
в тому випадку, коли  додаток чи прикладний
протокол вирішують його використовувати. Інакше
всі станції будуть мати рівні права доступу
до кільця, що в основному і відбувається на
практиці, тому що велика частина додатків цим механізмом не користується. Це зв'язано
з тим, що пріоритети кадрів підтримуються
не у всіх технологіях, наприклад у мережах Ethernet вони відсутні, тому додаток буде
поводитися по-різному, в залежності від
технології нижнього рівня, що небажано. У
сучасних мережах пріоритетність обробки
кадрів звичайно забезпечується  комутаторами чи маршрутизаторами, які підтримують
їх незалежно від використовуваних
протоколів канального рівня.</p>

<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="table1">
  <tr>
    <td width="100%" align="left" colspan="3"><hr color="#2D4C54" size="4"></td>
  </tr>
  <tr>
    <td width="33%" align="left"><a href="013.htm">Попередня</a></td>
    <td width="33%" align="center"><a href="001.htm">Перша</a></td>
    <td width="34%" align="right"><a href="015.htm">Наступна</a></td>
  </tr>
</table>

</body>

</html>